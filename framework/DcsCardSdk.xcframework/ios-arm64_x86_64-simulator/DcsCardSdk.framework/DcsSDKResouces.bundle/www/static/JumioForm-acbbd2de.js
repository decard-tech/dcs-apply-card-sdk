var je=Object.defineProperty,Ye=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var Ie=Object.getOwnPropertySymbols;var qe=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var ve=(t,a,d)=>a in t?je(t,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[a]=d,re=(t,a)=>{for(var d in a||(a={}))qe.call(a,d)&&ve(t,d,a[d]);if(Ie)for(var d of Ie(a))Me.call(a,d)&&ve(t,d,a[d]);return t},he=(t,a)=>Ye(t,Be(a));var ee=(t,a,d)=>new Promise((o,m)=>{var n=u=>{try{C(d.next(u))}catch(x){m(x)}},F=u=>{try{C(d.throw(u))}catch(x){m(x)}},C=u=>u.done?o(u.value):Promise.resolve(u.value).then(n,F);C((d=d.apply(t,a)).next())});import{r as y,u as U,a as ue,e,f as s,j as r,F as _,g as l,I as E,a0 as Y,k as B,b as Ae,B as q,K as b,a1 as K,a3 as Le,p as xe,ad as ze,J as He,h as de,ae as D,af as $e,ag as Ge,ah as Ke,ai as Ee,t as W,aj as We,ak as Qe,al as Ze,am as be,a4 as ge,m as Pe,an as me,ao as pe,ap as Ne,L as De,O as Ve,aq as Je,D as Xe,M as et,$ as tt,R as lt,ar as at}from"./index-6964e077.js";import{S as rt}from"./index-77d49db2.js";import{S as oe}from"./index-750b0c13.js";import{M as st,D as it,O as nt}from"./OTPInputPanel-6dedce77.js";import{D as se,M as Re,S as ot,F as ct}from"./myinfoform-bf2f482c.js";import{C as M}from"./card-5ffd29b5.js";import{C as fe}from"./index-400527c4.js";import{D as dt}from"./index-f481c4e9.js";import{R as ie}from"./index-39ddfd98.js";import{T as ye,I as pt,U as ce}from"./Upload-16471bb3.js";import"./search-bar-18f27248.js";import"./native-input-fa1ff988.js";import"./ResizeObserver.es-b51b3958.js";const mt=y.memo(()=>{var n,F;const{userMobile:t}=U(C=>C.app),{userInfo:a,applyPhoneNumberflag:d}=U(C=>C.user);let{applayCardDraftDataJumio:o,appliedCards:m}=U(C=>C.cardApply);return o=re({},o),ue(),y.useMemo(()=>{var C;return m[0]&&((C=m[0].productList[0])==null?void 0:C.tenCardsFlag)},[m]),d&&(o.mobile=(a==null?void 0:a.areaCode)+" "+(a==null?void 0:a.phoneNumber)),o?e(M,{title:e(s,{id:"apply_form_personal_info"}),className:"p-0 rounded-lg text-xs",headerClassName:"px-5",children:r(Y,{block:!0,direction:"vertical",className:"px-5 pb-5 rounded-lg",children:[e(_.Item,{name:"homeCountryIdNumber",label:e(s,{id:"apply_upgrade_home_country_num"}),rules:[{required:!0},{pattern:/^[a-zA-Z0-9-_ ]*$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:o==null?void 0:o.homeCountryIdNumber,children:e(E,{maxLength:20,placeholder:l("apply_form_please_enter")+l("apply_upgrade_home_country_num")})}),e(_.Item,{name:"email",label:e(s,{id:"apply_form_email"}),rules:[{required:!0,type:"email"}],initialValue:o==null?void 0:o.email,children:e(E,{maxLength:320,placeholder:l("apply_form_please_enter")+l("apply_form_email")})}),e(_.Item,{name:"mobile",label:e(s,{id:"apply_form_mobile_phone"}),rules:[{required:!0,validator:(C,u)=>{if(u!=null&&u.phone){if(u.areaCode==="+65"&&!/^[0-9]{8}$/.test(u.phone))return Promise.reject(l("rule_digits",{string:"8"}));if(u.areaCode==="+86"&&!/^[0-9]{11}$/.test(u.phone))return Promise.reject(l("rule_digits",{string:"11"}));if(!/^[0-9]{8,20}$/.test(u.phone))return Promise.reject(l("rule_digits",{string:"8-20"}))}return Promise.resolve()}}],initialValue:{areaCode:((n=(o==null?void 0:o.mobile)||t)==null?void 0:n.split(" ")[0])||"+65",phone:((F=(o==null?void 0:o.mobile)||t)==null?void 0:F.split(" ")[1])||""},children:e(st,{disabled:!!d})})]})}):e(B,{})}),ut=y.memo(()=>{var C,u,x;const{applayCardDraftDataJumio:t,jumioInfoData:a,appliedCards:d,billingAddressCountry:o}=U(i=>i.cardApply);U(i=>i.user);const m=Ae();y.useState(!1),y.useMemo(()=>({0:l("status_submitted"),1:l("status_processing"),2:l("status_approved"),3:l("status_supporting_documents"),4:l("status_rejected"),5:l("status_cancel")}),[]),console.log("appliedCards",d),console.log("jumioInfoData0",a),console.log("applayCardDraftDataJumio",t),(u=(C=d[0])==null?void 0:C.productList[0])!=null&&u.tenCardsFlag;const n=i=>{if(console.log("res地址是什么",i),!i)return"-";if(i.country==="SG")return`${i.block} ${i.street} # ${i.floor}-${i.unit} ${i.building||"-"} ${i.country} (${i.postal})`;if(i!=null&&i.line1)return`${i.line1} ${i==null?void 0:i.country}`},F=i=>typeof i!="string"||!i?"-":i.length===2?K("COUNTRY_CODE_ISO2",i):K("COUNTRY_CODE_ISO3",i);return t?r(Y,{direction:"vertical",block:!0,children:[e(M,{title:r("div",{className:"flex justify-between items-center text-sm",children:[e(s,{id:"apply_form_declaration_particulars"}),e(q,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{m("/jumio/0?back=true")},children:e(s,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg",headerClassName:"px-5",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_upgrade_home_country_num"}),e("span",{className:"w-2/4 text-xs text-right",children:t.homeCountryIdNumber})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_email"}),e("span",{className:"w-2/4 text-xs text-right",children:t.email})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_mobile_phone"}),e("span",{className:"w-2/4 text-xs text-right",children:t.mobile})]})]})}),e(M,{title:r("div",{className:"flex justify-between items-center text-sm",children:[e(s,{id:"apply_upgrade_address_info"}),e(q,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{m("/jumio/1?back=true")},children:e(s,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_residential_addr"}),e("span",{className:"w-2/4 text-xs text-right",children:n(t==null?void 0:t.residentAddress)})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_mailing_addr"}),e("span",{className:"w-2/4 text-xs text-right",children:n(t==null?void 0:t.billingAddress)})]})]})}),e(M,{title:r("div",{className:"flex justify-between items-center text-sm",children:[e(s,{id:"apply_upgrade_other_info"}),e(q,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{m("/jumio/2-1?back=true")},children:e(s,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_self_employed"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:t.selfEmployment})]}),t.selfEmployment==="N"&&r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_employer"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:t.companyName})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_job_industry"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:K("JOB_INDUSTRY",t.jobIndustry)})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_occupation"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:K("PROFESSION",t.profession)})]}),t.jobSeniorityList&&t.jobSeniorityList.length>0?r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_job_seniority_title"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.jobSeniorityList.map(i=>K("JOB_SENIORITY_LIST",i)).join(", ")})]}):null,r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_length_of_employment_b"}),r("span",{className:"w-2/4 text-xs text-right capitalize",children:[t.serviceYears,l("apply_form_years"),"  ",t.serviceMonths,l("apply_form_months")]})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_gross_annual_income"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:e(Le,{value:Number(t.incomeYear)/100,style:"currency",currency:"SGD"})})]}),t.purposeOfAccountList&&t.purposeOfAccountList.length>0?r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_account_purpose_title"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.purposeOfAccountList.map(i=>K("PURPOSE_OF_ACCOUNT_LIST",i)).join(", ")})]}):null,t.sourceOfFundsList&&t.sourceOfFundsList.length>0?r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_source_of_funds"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.sourceOfFundsList.map(i=>K("SOURCE_OF_FUNDS_LIST",i)).join(", ")})]}):null,t.sourceOfFundsCountryList&&t.sourceOfFundsCountryList.length>0?r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_source_of_funds_country"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.sourceOfFundsCountryList.map(i=>K("SOURCE_OF_FUNDS_COUNTRY_LIST",i)).join(", ")})]}):null,t.sourceOfWealthList&&t.sourceOfWealthList.length>0?r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_source_of_wealth"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.sourceOfWealthList.map(i=>K("SOURCE_OF_WEALTH_LIST",i)).join(", ")})]}):null]})}),["identityFiles","passportFiles","incomeProofFiles","addressProofFiles","studentIdFiles","parentConsentFiles","otherDetailsFiles"].find(i=>{var S;return t&&((S=t[i])==null?void 0:S.length)})&&e(M,{title:r("div",{className:"flex justify-between items-center text-sm",children:[e(s,{id:"apply_form_upload_docs"}),e(q,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{m("/jumio/2-2?back=true")},children:e(s,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:e(Y,{direction:"vertical",block:!0,className:"px-5",children:["identityFiles","passportFiles","incomeProofFiles","addressProofFiles","studentIdFiles","parentConsentFiles","otherDetailsFiles"].filter(i=>{var S;return(S=t[i])==null?void 0:S.length}).map(i=>e(_t,{title:l(`apply_manual_upload_${i}`),data:t[i]},i))})}),e(M,{title:r("div",{className:"flex justify-between items-center text-sm",children:[e(s,{id:"apply_form_card_personalization"}),e(q,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{m("/jumio/3?back=true")},children:e(s,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_credit_lit_preference"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:(t==null?void 0:t.determineLimitFlag)==="N"?e(Le,{value:Number(t.preCreditLimit),style:"currency",currency:"SGD"}):e(s,{id:"apply_form_let_dcs_determine"})})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_name_on_card"}),e("span",{className:"w-2/4 text-xs text-right capitalize",children:t.preNameOnCard})]})]})}),e(M,{title:e("div",{className:"flex justify-between items-center text-sm",children:e(s,{id:"apply_jumio_passport"})}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_name"}),e("span",{className:"w-2/4 text-xs text-right",children:`${a==null?void 0:a.idResult.firstName} ${a==null?void 0:a.idResult.lastName}`})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_gender"}),e("span",{className:"w-2/4 text-xs text-right",children:K("GENDER",a==null?void 0:a.idResult.gender)})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_date_of_birth"}),e("span",{className:"w-2/4 text-xs text-right",children:a!=null&&a.idResult.dateOfBirth?xe(a==null?void 0:a.idResult.dateOfBirth).format("DD MMM YYYY"):""})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_nationality"}),e("span",{className:"w-2/4 text-xs text-right",children:F((x=a==null?void 0:a.idResult)==null?void 0:x.nationality)})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_passport_num"}),e("span",{className:"w-2/4 text-xs text-right",children:a==null?void 0:a.idResult.idNumber})]}),r("div",{className:"flex justify-between items-center",children:[e(b,{className:"text-minor text-xs",id:"apply_form_passport_expiry_date"}),e("span",{className:"w-2/4 text-xs text-right",children:a!=null&&a.idResult.expiryDate?xe(a==null?void 0:a.idResult.expiryDate).format("DD MMM YYYY"):""})]})]})}),e(M,{title:e("div",{children:e(s,{id:"apply_form_declaration_consent_title"})}),children:r(Y,{direction:"vertical",block:!0,children:[e(_.Item,{name:"dncFlag",children:e(fe,{children:r("p",{className:"ml-3",children:[" ",l("apply_form_declaration_1a")]})})}),e(_.Item,{name:"usaTaxResident",children:e(fe,{children:r("p",{className:"ml-3",children:[l("apply_form_declaration_3a"),e("br",{}),l("apply_form_declaration_3b"),e("br",{}),l("apply_form_declaration_3c")]})})}),e(_.Subscribe,{to:["usaTaxResident"],children:({usaTaxResident:i})=>{if(i)return e(_.Item,{label:e(s,{id:"apply_form_declaration_3d"}),name:"usaTaxTin",rules:[{required:!0},{pattern:/^[\w\s]{1,23}$/,message:l("rule_characters",{string:"1-23"})}],children:e(E,{maxLength:23,placeholder:l("apply_form_declaration_3e")})})}}),e(_.Item,{name:"pdpaFlag",rules:[{validator:(i,S)=>S?Promise.resolve():Promise.reject(new Error(l("apply_form_please_check")))}],children:e(fe,{children:r("div",{className:"ml-3",children:[e("span",{className:"text-red",children:"*"}),e(s,{id:"apply_form_authorization_text"}),e(s,{id:"apply_form_authorization_text2"}),e(s,{id:"apply_form_dcs_charge_credit1"}),e(s,{id:"apply_form_conditions"}),e(s,{id:"apply_form_application"})]})})})]})})]}):e(B,{})}),_t=({title:t,data:a})=>r("div",{className:"flex text-xs",children:[e("span",{children:t}),e("div",{style:{width:"60%"},children:a==null?void 0:a.map((d,o)=>e("p",{className:"text-blue",children:d.attachedName},o))})]}),ht=y.memo(()=>{const{applayCardDraftDataJumio:t,appliedCards:a}=U(o=>o.cardApply);console.log("applayCardDraftDataJumio======"+JSON.stringify(t));const d=y.useMemo(()=>{var o;return a[0]&&((o=a[0].productList[0])==null?void 0:o.tenCardsFlag)},[a]);return t?e(M,{headerClassName:"px-5",title:e("div",{children:e(b,{id:"apply_upgrade_occupation_income"})}),className:"p-0 rounded-lg",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[e(_.Item,{name:"selfEmployment",rules:[{required:!0}],initialValue:t.selfEmployment==="Y",children:e(fe,{children:e(s,{id:"apply_form_i_am_self_employed"})})}),e(_.Subscribe,{to:["selfEmployment"],children:({selfEmployment:o})=>{if(!o)return e(_.Item,{name:"companyName",label:e(s,{id:"apply_form_employer"}),rules:[{required:!0},{pattern:/^[A-Za-z-_ ]*$/,message:l("rule_alphabets_spaces_hyphens")}],children:e(E,{maxLength:80,autoCapitalize:"characters",placeholder:l("apply_form_please_enter")+l("apply_form_employer")})})}}),e(_.Item,{name:"jobIndustry",label:e(s,{id:"apply_form_job_industry"}),rules:[{required:!0}],initialValue:t.jobIndustry,children:e(se,{dictType:"JOB_INDUSTRY"})}),e(_.Item,{name:"profession",label:e(s,{id:"apply_form_occupation"}),rules:[{required:!0}],initialValue:t.profession,children:e(se,{dictType:"PROFESSION"})}),e(_.Item,{name:"jobSeniorityList",label:e(s,{id:"apply_form_job_seniority_title"}),rules:[{required:!0}],initialValue:t.jobSeniorityList?[t.jobSeniorityList]:null,children:e(se,{dictType:"JOB_SENIORITY_LIST",placeholder:l("apply_form_please_choose")})}),e(_.Item,{name:"yearsWorking",trigger:"onConfirm",label:e(s,{id:"apply_form_length_of_employment"}),rules:[{required:!0}],onClick:(o,m)=>{var n;(n=m.current)==null||n.open()},children:e(ze,{columns:[new Array(99).fill(1).map((o,m)=>({label:`${++m} ${l("apply_form_years")}`,value:m})),new Array(12).fill(1).map((o,m)=>({label:`${m} ${l("apply_form_months")}`,value:m}))],children:o=>r("div",{className:"adm-input flex justify-between",style:{color:o.length?"#25435f":"#909daa",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[e("span",{children:o.length?o.map(m=>m==null?void 0:m.label).join(" "):l("apply_form_please_choose")}),e(it,{color:"#000",fontSize:12})]})})}),e(_.Item,{name:"incomeYear",label:r("p",{children:[e(s,{id:"apply_form_gross_annual_income"}),"(S$)"]}),rules:[{required:!0},{pattern:/^([1-9]{1}\d*)(\.\d{1,2})?$/,message:l("rule_invalid_input")}],children:e(E,{maxLength:10,autoCapitalize:"characters",placeholder:l("apply_form_please_enter")+l("apply_form_gross_annual_income")})}),e(_.Item,{name:"purposeOfAccountList",label:e(s,{id:"apply_form_account_purpose_title"}),rules:[{required:!0}],initialValue:t.purposeOfAccountList?[t.purposeOfAccountList]:null,children:e(se,{dictType:"PURPOSE_OF_ACCOUNT_LIST",placeholder:l("apply_form_please_choose")})}),e(_.Item,{name:"sourceOfFundsList",label:e(s,{id:"apply_form_source_of_funds_title"}),rules:[{required:!0}],initialValue:t.sourceOfFundsList?[t.sourceOfFundsList]:null,children:e(Re,{dictType:"SOURCE_OF_FUNDS_LIST",placeholder:l("apply_form_please_choose")})}),e(_.Item,{name:"sourceOfFundsCountryList",label:e(s,{id:"apply_form_source_of_funds_country"}),rules:[{required:!0}],initialValue:t.sourceOfFundsCountryList?[t.sourceOfFundsCountryList]:null,children:e(se,{dictType:"SOURCE_OF_FUNDS_COUNTRY_LIST",placeholder:l("apply_form_please_choose")})}),e(_.Item,{name:"sourceOfWealthList",label:e(s,{id:"apply_form_source_of_wealth_title"}),rules:[{required:!0}],initialValue:t.sourceOfWealthList?[t.sourceOfWealthList]:null,children:e(Re,{dictType:"SOURCE_OF_WEALTH_LIST",placeholder:l("apply_form_please_choose")})}),t.isAlien==="0"&&!d&&e(_.Item,{name:"empPassExpiryDate",label:e(s,{id:"apply_form_employment_pass_expiry"}),trigger:"onConfirm",onClick:(o,m)=>{var n;(n=m.current)==null||n.open()},rules:[{required:!0}],initialValue:t.empPassExpiryDate?new Date(t.empPassExpiryDate):void 0,children:e(dt,{children:o=>e("div",{className:`adm-input ${o?"text-default":"text-minor"}`,children:o?e(He,{value:o}):l("apply_form_please_enter")+l("apply_form_employment_pass_expiry")})})})]})}):e(B,{})}),ft=y.memo(()=>{var C;const t=U(u=>u.user),{applayCardDraftDataJumio:a,appliedCards:d}=U(u=>u.cardApply),[o,m]=y.useState(a==null?void 0:a.preNameOnCard),n=d[0]&&((C=d[0].productList[0])==null?void 0:C.fixedLimit)==="1",F=u=>{m(u.toLocaleUpperCase())};return a?r("div",{children:[!n&&e(M,{headerClassName:"px-5",title:e("div",{children:e(b,{id:"apply_form_credit_lit_preference"})}),className:"p-0 rounded-lg",children:r(Y,{direction:"vertical",block:!0,className:"px-5",children:[e(_.Item,{name:"determineLimitFlag",rules:[{required:!0}],initialValue:"Y",children:e(ie.Group,{children:r(Y,{direction:"vertical",children:[e(ie,{value:"Y",children:e(s,{id:"apply_form_let_dcs_determine"})}),e(ie,{value:"N",children:e(s,{id:"apply_form_set_my_preferred_limit"})})]})})}),e(_.Subscribe,{to:["determineLimitFlag"],children:({determineLimitFlag:u})=>{if(console.log("determineLimitFlag",u),u!=="Y")return r("div",{className:"mt-10",children:[e(_.Item,{name:"preCreditLimit",rules:[{required:!0}],initialValue:1,children:e(ot,{residentPopover:!0,step:1,max:150,min:1,popover:x=>e("span",{children:x*1e3}),icon:e(gt,{})})}),r("div",{className:"flex justify-between text-xs",children:[e("span",{children:"S$ 1,000"}),e("span",{children:"S$ 150,000"})]}),e(b,{className:"text-xs text-minor mx-6 my-6 text-center",id:"apply_form_credit_limit_tip"})]})}})]})}),e(M,{headerClassName:"px-5 ",title:e("div",{children:e(b,{id:"apply_form_name_on_card"})}),className:"p-0 rounded-lg mt-4",children:r("div",{className:"px-5",children:[e(_.Item,{name:"preNameOnCard",label:e(s,{id:"apply_form_embossed_name"}),rules:[{required:!0}],initialValue:a==null?void 0:a.preNameOnCard,children:e(E,{maxLength:19,minLength:2,autoCapitalize:"characters",onChange:F})}),d.map(u=>{let x=t.sdkData.productInfo.find(i=>i.productCode===u.productList[0].productCode);return r("div",{className:"mt-5 relative",children:[e(de,{src:x&&x.cardFace?x.cardFace:u.channelCardShowImage,alt:u.channelCardName}),e("span",{style:{position:"absolute",bottom:0,left:0},className:"text-base font-medium text-white pl-5 pb-5",children:t!=null&&t.showCardNameMaskOnCardFlag?o:""})]},u.channelCreditCardId)})]})})]}):e(B,{})}),gt=()=>r("svg",{width:"38",height:"18",viewBox:"0 0 38 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"0.5",y:"0.5",width:"37",height:"17",rx:"8.5",fill:"#3366FF",stroke:"#E3FAFF"}),e("rect",{x:"16",y:"4",width:"10",height:"2",rx:"1",transform:"rotate(90 16 4)",fill:"#ACF0FF"}),e("rect",{x:"20",y:"4",width:"10",height:"2",rx:"1",transform:"rotate(90 20 4)",fill:"#ACF0FF"}),e("rect",{x:"24",y:"4",width:"10",height:"2",rx:"1",transform:"rotate(90 24 4)",fill:"#ACF0FF"})]});const yt="/static/uploadExample-b941204b.png",xt=()=>{var w;const{postcodeGetAddress:t,uploadButtonVisible:a,cameraPageCountry:d,uploadLoading:o,postAddressDetailsHiding:m,applayCardDraftDataJumio:n,addressDetailsHiding:F}=U(f=>f.cardApply),[C,u]=y.useState(!1),x=ue();console.log(">>>>>>>>>>>>>>>",n);const[i,S]=y.useState(!1),[j,c]=y.useState(""),[P,L]=y.useState(!1),[p,J]=y.useState(!1),[A,R]=y.useState(""),[v,I]=y.useState(""),$=Ae(),T=y.useRef(null);console.log("uploadButtonVisible状态是什么",a,o);const V=f=>{let O="";f=="reside"?(L(!0),O=A):(J(!0),O=v),W("/dcs-apply-online/card/apply/utils/addressLookup",{postalCode:O}).then(k=>{f=="reside"?(x(We(k.address)),x(Ee(!0))):(x(Qe(k.address)),x(Ze(!0)))}).finally(()=>{L(!1),J(!1)})},H=()=>{console.log("childRef.current",T.current),T.current&&T.current.onOpen()};return n?e("div",{children:r("div",{children:[e(M,{title:r("div",{children:[e(s,{id:"apply_form_residential_addr"}),e(b,{className:"font-normal text-xs text-minor",id:"apply_upgrade_header_tip"})]}),className:"p-0 rounded-lg shadow-lg bg-white",headerClassName:"px-5",children:r("div",{children:[e(_.Item,{className:"formItemCustom",name:["residentAddress","country"],label:e(s,{id:"apply_form_property_country"}),rules:[{required:!0}],initialValue:((w=n.residentAddress)==null?void 0:w.country)||((n==null?void 0:n.nationality)=="CHN"?"CN":"SG"),children:e(se,{dictType:"COUNTRY_CODE_ISO2"})}),e(_.Subscribe,{to:["residentAddress","country"],children:({residentAddress:f})=>{var O,k,G,z,te,Q,le,ae;return console.log("表单变化了",f,d),R(f==null?void 0:f.postal),c(f==null?void 0:f.country),d&&(f==null?void 0:f.country)!=d&&x(D(!0)),(f==null?void 0:f.country)!="CN"?r(B,{children:[e("div",{className:"my-3 text-sm",children:l("upload_address_file_sg")}),r("div",{className:"leading-6 text-xs",children:[e("p",{className:"text-[#909DAA] ",children:l("upload_address_file_sg_desc1")}),e("p",{className:"text-[#909DAA] ",children:l("upload_address_file_sg_desc2")})]}),a&&e(q,{loading:o,loadingText:l("jumio_uploading_title"),className:"mt-3 w-44 bg-[#36f] text-[#FFF] text-sm",onClick:()=>S(!0),children:l("upload_address_file_sg_btn")}),e(Te,{ref:T,turnOnTheCamera:j}),!a&&(f==null?void 0:f.country)=="SG"&&r("div",{style:{position:"relative"},children:[e(_.Item,{name:["residentAddress","postal"],label:e(s,{id:"apply_form_postal_code"}),rules:[{required:!0},{pattern:/^[0-9]{6,6}$/,message:l("rule_digits",{string:6})}],initialValue:(O=n.residentAddress)==null?void 0:O.postal,children:e(E,{type:"number",placeholder:l("apply_form_please_enter")+l("apply_form_postal_code")})}),e(q,{color:"primary",loading:P,onClick:()=>V("reside"),style:{position:"absolute",right:"10px",top:"43px",width:"100px",height:"32px",fontSize:"14px",padding:"0 0 0.5px 0"},children:l("apply_form_geturl")})]}),F&&(f==null?void 0:f.country)=="SG"&&r(B,{children:[e(_.Item,{name:["residentAddress","block"],label:e(s,{id:"apply_form_block"}),rules:[{required:!0},{pattern:/^[\w\s]{1,10}$/,message:l("rule_characters",{string:"1-10"})}],initialValue:(k=n.residentAddress)==null?void 0:k.block,children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_block")})}),e(_.Item,{name:["residentAddress","street"],label:e(s,{id:"apply_form_street_name"}),rules:[{required:!0},{pattern:/^[\w\s]{1,66}$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(G=n.residentAddress)==null?void 0:G.street,children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_street_name")})}),e(_.Item,{name:["residentAddress","floor"],label:e(s,{id:"apply_upgrade_floor_name"}),rules:[{required:!0},{pattern:/^[A-Za-z0-9]{1,5}$/,message:l("rule_characters",{string:"1-5"})}],initialValue:(z=n.residentAddress)==null?void 0:z.floor,help:e(s,{id:"apply_upgrade_input_tip"}),children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_upgrade_floor_name")})}),e(_.Item,{name:["residentAddress","unit"],label:e(s,{id:"apply_form_unit"}),rules:[{required:!0},{pattern:/^[0-9]{1,5}$/,message:l("rule_digits",{string:"1-5"})}],initialValue:(te=n.residentAddress)==null?void 0:te.unit,help:e(s,{id:"apply_upgrade_input_tip2"}),children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_unit")})}),e(_.Item,{name:["residentAddress","building"],label:e(s,{id:"apply_form_building"}),rules:[{pattern:/^[\w\s]{1,66}$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(Q=n.residentAddress)==null?void 0:Q.building,children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_building")})})]}),(f==null?void 0:f.country)!="SG"&&!a&&e(_.Item,{name:["residentAddress","line1"],label:e(s,{id:"apply_form_permanent_home_addr"}),rules:[{required:!0},{pattern:/^[a-zA-Z0-9 ,.\-#]+$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(le=n.residentAddress)==null?void 0:le.block,children:e(ye,{showCount:!0,maxLength:200,placeholder:l("apply_form_please_enter")+l("apply_form_permanent_home_addr")})})]}):r(B,{children:[e("div",{className:"mt-3 text-sm",children:l("upload_address_file_sg")}),r("div",{className:"text-[#909DAA] text-sm leading-6",children:[l("upload_address_file_zh_desc1"),e("span",{className:"text-[#25435F] text-sm underline",children:l("upload_address_file_zh_desc2")}),l("upload_address_file_zh_desc3")]}),a&&e(q,{loading:o,loadingText:l("jumio_uploading_title"),className:"mt-3 w-44 bg-[#36f] text-[#FFF] mb-3 text-sm",onClick:()=>S(!0),children:l("upload_address_file_zh_btn")}),e(Te,{ref:T,turnOnTheCamera:j}),!a&&e(_.Item,{name:["residentAddress","line1"],label:e(s,{id:"apply_form_permanent_home_addr"}),rules:[{required:!0},{pattern:/^[a-zA-Z0-9 ,.\-#]+$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(ae=n.residentAddress)==null?void 0:ae.block,children:e(ye,{showCount:!0,maxLength:200,placeholder:l("apply_form_please_enter")+l("apply_form_permanent_home_addr")})})]})}})]})}),e(M,{title:r("div",{children:[e(s,{id:"apply_form_mailing_addr"}),e(b,{className:"font-normal text-xs text-minor",id:"apply_upgrade_mailing_address_tip1"}),e(b,{className:"font-normal text-xs text-minor",id:"apply_upgrade_mailing_address_tip3"})]}),className:"mt-5 p-0 rounded-lg shadow-lg bg-white",headerClassName:"px-5",children:r(Y,{direction:"vertical",className:"px-5",block:!0,children:[e(_.Item,{initialValue:"Y",name:"sameResidentialFlag",rules:[{required:!0}],children:e(ie.Group,{onChange:f=>{f==="N"&&(u(!0),x($e(!1)))},children:r(Y,{children:[e(ie,{value:"Y",children:e(s,{id:"apply_form_same_as_residential_addr"})}),e(ie,{value:"N",children:e(s,{id:"apply_upgrade_other_addresses"})})]})})}),e(Ge,{visible:C,content:l("mailing_address_other_tips"),closeOnAction:!0,onClose:()=>{u(!1)},actions:[{key:"confirm",text:l("confirm_switching_address")}]}),e(_.Subscribe,{to:["sameResidentialFlag"],children:({sameResidentialFlag:f})=>(console.log("sameResidentialFlag",f),e(B,{children:e(_.Subscribe,{to:["billingAddress","country"],children:({billingAddress:O})=>{var k,G,z,te,Q,le,ae,N;return I(O==null?void 0:O.postal),f==="Y"?r(B,{children:[r("div",{style:{position:"relative"},children:[e(_.Item,{name:["billingAddress","postal"],label:e(s,{id:"apply_form_postal_code"}),rules:[{required:!0},{pattern:/^[0-9]{6,6}$/,message:l("rule_digits",{string:6})}],initialValue:(k=n.billingAddress)==null?void 0:k.postal,children:e(E,{type:"number",placeholder:l("apply_form_please_enter")+l("apply_form_postal_code")})}),e(q,{color:"primary",loading:p,onClick:()=>V("post"),style:{position:"absolute",right:"10px",top:"43px",width:"100px",height:"32px",fontSize:"14px",padding:"0 0 0.5px 0"},children:l("apply_form_geturl")})]}),m&&r(B,{children:[e(_.Item,{name:["billingAddress","street"],label:e(s,{id:"apply_form_street_name"}),rules:[{required:!0},{pattern:/^[\w\s]{1,66}$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(G=n.billingAddress)==null?void 0:G.street,children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_street_name")})}),e(_.Item,{name:["billingAddress","block"],label:e(s,{id:"apply_form_block"}),rules:[{required:!0},{pattern:/^[\w\s]{1,10}$/,message:l("rule_characters",{string:"1-10"})}],initialValue:(z=n.billingAddress)==null?void 0:z.block,children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_block")})}),e(_.Item,{name:["billingAddress","floor"],label:e(s,{id:"apply_upgrade_floor_name"}),rules:[{required:!0},{pattern:/^[A-Za-z0-9]{1,5}$/,message:l("rule_characters",{string:"1-5"})}],initialValue:(te=n.billingAddress)==null?void 0:te.floor,help:e(s,{id:"apply_upgrade_input_tip"}),children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_upgrade_floor_name")})}),e(_.Item,{name:["billingAddress","unit"],label:e(s,{id:"apply_form_unit"}),rules:[{required:!0},{pattern:/^[0-9]{1,5}$/,message:l("rule_digits",{string:"1-5"})}],initialValue:(Q=n.billingAddress)==null?void 0:Q.unit,help:e(s,{id:"apply_upgrade_input_tip2"}),children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_unit")})}),e(_.Item,{name:["billingAddress","building"],label:e(s,{id:"apply_form_building"}),rules:[{pattern:/^[\w\s]{1,66}$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(le=n.billingAddress)==null?void 0:le.building,children:e(E,{placeholder:l("apply_form_please_enter")+l("apply_form_building")})})]})]}):r(B,{children:[e(_.Item,{name:["billingAddress","country"],label:e(s,{id:"apply_form_property_country"}),rules:[{required:!0}],initialValue:((ae=n.billingAddress)==null?void 0:ae.country)||"CN",children:e(se,{dictType:"COUNTRY_CODE_ISO2",nonSingapore:!0})}),e(_.Item,{name:["billingAddress","line1"],label:e(s,{id:"apply_form_permanent_home_addr"}),rules:[{required:!0},{pattern:/^[a-zA-Z0-9 ,.\-#]+$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:(N=n.billingAddress)==null?void 0:N.block,children:e(ye,{showCount:!0,maxLength:200,placeholder:l("apply_form_please_enter")+l("apply_form_permanent_home_addr")})})]})}})}))})]})}),r(Ke,{visible:i,showCloseButton:!0,bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px",minHeight:"40vh",paddingLeft:"10px",paddingRight:"10px",paddingBottom:"50px"},onMaskClick:()=>{S(!1)},onClose:()=>{S(!1)},children:[e("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"10px",fontWeight:"700",fontSize:"16px"},children:l("apply_guide_select_upload_method")}),e("div",{style:{backgroundColor:"#F6F8FB",minHeight:"100px",marginTop:"10px",display:"flex",flexDirection:"column",justifyContent:"space-around",padding:"20px 15px"},children:r("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"},children:[e("div",{children:e(de,{src:yt})}),r("div",{className:"leading-7 mt-3",children:[e("p",{children:l("orcDangerTips1")}),e("p",{children:l("orcDangerTips2")}),e("p",{children:l("orcDangerTips3")})]})]})}),r("div",{style:{display:"flex",flexDirection:"column",marginTop:"20px"},children:[e(q,{color:"primary",fill:"none",onClick:()=>{S(!1),x(D(!1)),$("/jumio/12",{state:{certificate:j}})},children:l("apply_guide_take_picture")}),e(q,{color:"primary",fill:"none",onClick:()=>{S(!1),H()},children:l("apply_guide_upload_album")}),e(q,{color:"primary",shape:"rounded",className:"mt-4",onClick:()=>S(!1),children:l("cant_apply_physical_card_dialog_cancle")})]})]})]})}):e(B,{})},Te=y.forwardRef((t,a)=>{y.useRef();const d=y.useRef(null),{turnOnTheCamera:o,switchingaddressDetailsHiding:m}=t;y.useState(!0);const{applayCardDraftDataJumio:n,channelApplyNo:F,uploadButtonVisible:C,addressCcertificate:u}=U(A=>A.cardApply),x=ue(),[i,S]=y.useState([]);y.useEffect(()=>{u&&S([{url:u}])},[u]);const j=(A,R)=>{W("/dcs-apply-online/card/apply/utils/externalOcr",{channelApplyNo:F,attachedType:"3",base64Image:A,ocrRequestType:"CHECK_ADDRESS",docType:"library",attachedName:"dcs-apply-online/"+R}).then(v=>{if(console.log("相册验证",v),o==="CN"&&v.ocrAddressResult==="F"&&v.ocrIdentifyType==="CHINA_ID")return ge.show({content:l("uploadd_ocr_fail"),afterClose:()=>{console.log("after")}}),!1;x(pe(o)),x(Ne(v)),x(D(!1))}).finally(()=>{x(be(!1))})};function c(A,R){console.log("beforeUpload",A,R),x(be(!0));const v=new FileReader;v.onload=T=>ee(this,null,function*(){const V=T.target.result;try{const f=(yield P(V)).split(",")[1];j(f,A.name)}catch(H){console.error("图片压缩出错:",H)}}),v.readAsDataURL(A);const I=10*1024,$=10*1024*1024;return A.size<I?(ge.show(l("file_is_too_small")),null):A.size>$?(ge.show(l("apply_form_accept_formats")),null):A}function P(A,R=500,v=.3){return new Promise((I,$)=>{const T=new Image;T.src=A,T.onload=()=>{const V=document.createElement("canvas"),H=V.getContext("2d");let w=T.width,f=T.height;w>R&&(f=R/w*f,w=R),V.width=w,V.height=f,H.drawImage(T,0,0,w,f);const O=V.toDataURL("image/jpeg",v);I(O)},T.onerror=V=>{$(V)}})}const L=(A,R)=>ee(void 0,null,function*(){console.log("------------file文件名",A);try{const v=yield W("/dcs-apply-online/card/apply/fileUpload",{channelApplyNo:F,attachedType:3,fileSuffix:A.type.split("/")[1],attachedName:A.name});console.log("imageUpload",v),new FormData().append("file",A);const $=yield Pe.put(v.imageTempUrl,A,{headers:{"Content-Type":A.type}});return{key:A.name+Math.random(),url:URL.createObjectURL(A),extra:v.attachedImage}}catch(v){throw console.log("errr",v),new Error("error")}}),p=A=>ee(void 0,null,function*(){if(console.log("文件列表更新：",A),A.length>1){const R=A[1];console.log("处理后文件列表更新：",R),S([R]),x(me(R.url))}else S(A),x(me(A[0].url))}),J=()=>{var R;const A=(R=d.current)==null?void 0:R.nativeElement;A&&A.click()};return y.useImperativeHandle(a,()=>({onOpen:J})),e("div",{style:{display:C?"none":"block",margin:"20px 0"},children:e(pt,{ref:d,value:i,onChange:p,upload:L,maxCount:2,showUpload:!1,beforeUpload:c,onDelete:A=>{x(D(!0)),x(Ee(!1))}})})}),bt=y.memo(()=>{var x,i,S,j,c,P,L;const{applayCardDraftDataJumio:t,appliedCards:a}=U(p=>p.cardApply);U(p=>p.user),console.log("90909090909090",a,t);const d=De.get("environment")==="pro"?"https://cardsminio.dcscc.com":"https://sitcardsminio.dcscc.com";let o=(x=t==null?void 0:t.addressProofFiles)==null?void 0:x.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()}));(i=t==null?void 0:t.passportFiles)==null||i.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()}));let m=(S=t==null?void 0:t.identityFiles)==null?void 0:S.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()})),n=(j=t==null?void 0:t.incomeProofFiles)==null?void 0:j.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()}));(c=t==null?void 0:t.otherDetailsFiles)==null||c.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()}));let F=(P=t==null?void 0:t.studentIdFiles)==null?void 0:P.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()})),C=(L=t==null?void 0:t.parentConsentFiles)==null?void 0:L.map(p=>({url:d+p.attachedImage,extra:p.attachedImage,key:p.attachedImage+Math.random()}));console.log("addressProofFiles",o);const u=y.useMemo(()=>{var p;return a[0]&&((p=a[0].productList[0])==null?void 0:p.tenCardsFlag)},[a]);return t?e("div",{className:"pt-3",children:r(M,{headerClassName:"px-5",className:"p-0 rounded-lg",children:[t.isAlien=="1"&&!u?e(_.Item,{className:"upload-box",name:"identityFiles",initialValue:t.identityFiles,rules:[{required:!0,message:l("apply_form_please_upload")}],label:r("div",{children:[e(b,{className:"font-bold text-sm mb-2",id:"apply_manual_upload_your_id_document"}),e(b,{className:"text-minor text-xs mb-2",id:"apply_guide_id_tip"})]}),children:e(ce,{attachedType:1,maxCount:2,value:m})}):null,!u&&r(Y,{direction:"vertical",block:!0,style:{background:"rgb(246, 248, 251)"},children:[e(_.Item,{name:"incomeProofFiles",required:!0,rules:[{required:!0,message:l("apply_form_please_upload")}],label:r("div",{children:[e(b,{className:"font-bold text-sm mb-2",id:"apply_manual_upload_incomeProofFiles"}),e(b,{className:"text-minor text-xs mb-2",id:"apply_guide_proof_income_tip"})]}),className:"upload-box",children:e(ce,{attachedType:2,maxCount:3,value:n})}),t.profession=="1191"&&e(_.Item,{name:"studentIdFiles",rules:[{required:!0,message:l("apply_form_please_upload")}],initialValue:t.studentIdFiles,label:r("div",{children:[e(b,{className:"font-bold text-sm mb-2",id:"apply_manual_upload_studentIdFiles"}),e(b,{className:"text-minor text-xs mb-2",id:"apply_guide_student"})]}),className:"upload-box",children:e(ce,{attachedType:4,maxCount:1,value:F})}),Number(t==null?void 0:t.age)<21&&e(_.Item,{name:"parentConsentFiles",rules:[{required:!0,message:l("apply_form_please_upload")}],initialValue:t.studentIdFiles,label:r("div",{children:[e(b,{className:"font-bold text-sm mb-2",id:"apply_manual_upload_parentConsentFiles"}),e(b,{className:"text-minor text-xs mb-2",id:"apply_manual_upload_parent"}),e(b,{className:"text-minor text-xs mb-2",id:"apply_guide_parent_example"})]}),className:"upload-box",children:e(ce,{attachedType:5,maxCount:1,value:C})})]}),e(_.Item,{className:"upload-box",name:"addressProofFiles",initialValue:t.addressProofFiles,label:r("div",{className:"",children:[e(b,{className:"font-bold text-sm mb-2",id:"apply_manual_upload_addressProofFiles"}),t.isAlien==="1"&&e(b,{className:"text-minor text-xs",id:"apply_guide_proof_address_tip1"}),e(b,{className:"text-minor text-xs mb-2",id:"apply_guide_proof_address_tip2"})]}),rules:[{required:!0,message:l("apply_form_please_upload")}],getValueFromEvent:p=>p,children:e(ce,{attachedType:3,maxCount:3,value:o})})]})}):e(B,{})}),Nt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAYAAAAbBi9cAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADsSURBVHgBpVSBEYIwDEw9B2ADOwIbiBPoBjKCG+gIbCAbeE4gG+AG4ATgBDWRwOVyuaMHf5dL2rTffENxIYQEAHI08kvQolUOiV4YZLAOf6KgJnu0JwwVHiESWzVu0Q7OOfKAZ6ToapH/GBw74MUSF72KpHOuM0goX1ByC/P4sk+YrFd5b1VUcxfHnA+RAGOuIYloV6rAyKcx0saOjeVTfFZrHrivFeNUSyulLCWvCZHSGotEkGVq340P8FzARFTADMLQCHmPd7ZO3tEe43yGS1bsYXifE6wnsggbtArW400VeQxOsPw3Qp9K+QO87FTcxB1oCwAAAABJRU5ErkJggg==",At="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABGCAYAAABxLuKEAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAV3SURBVHgB7VyBldo4EB22Aq6C+CpgO4ivguxVgK+CowNIBUsqgA5CKsCpIGwF8lawmwommrW0DGIky2Ab22//e8JGHsnS12gkWyNPoEMg4r0+2PDJHAmJI1ro8GrCk/mfTyaTA3SECbQITcRUHzIdvkBJwhSuAxGV6/ADSqIKGBI0IakOe2wf33V4gBbQqMboQmb6sITzrmHxDGWLU5coTHh1W17nQ+mnJh/b9WaBfCn9V53PFvoEoyHK06q5DgtT2WvvkxD5Jk8JyjTObWEKuhcK+KLDCksb0+a9tyg3yKaJhri0YAtDQKeECOWYmrIooSwZdAVTkEehldZdEiKUy2qQi0e4ALWMr1HP73CcfxAKHf7Thi+vkUcKx7kM/XcJ5XOYXIdD7NBs8t/DqaEmY/9vK8O7aRF1iZZgaZzX6DfQMVBY2o77iPtNzf3c9Ak0CQ8pi4h0D9jOfOYXRtgPLO1dO+R4SMkq0oSG7yahIsqSCWkSaICYX07G9wFZ3/DdNjYYqCyV2ZGnOl0+UOD56JMFZElLXvB2UBh4PMBzzblotJIyWgVkl9gfLAPlXDiylXbSzYC6BG/9NQyDFIsQOXy0ojomUIMYPlFS6OmP2E9SLJaeMtNQrpjcHmKA510oGSApFj5yUkcuhQhiFEuw8cg84HCQeurAu5SqIoVri0JBW1Ce1/QZoh3BsktxO5pBpLYsPDJbHB72nrqsmIzykcK7h0LB4OK5/RkSUqjWmlQiZscENhEaNTQoqNaavXsxcTJJRqYtFplHazjeesqduZ4y2Z+e9xb/w/AxdyN0Xe2SjEVGP5YY/oyxdRPjcaFs6KD5SyrE/2DntAb2TsxndiEXEtZ7pug3pAfNHTt/U4A7ow12BCo83egzjAdf3AhT52fzl2zOPWlMymSe3ERYGuIExoME5cecnJ2/EcOFpEXzMdgWF6kQx+v+RszMczGUydAhNXbBzhMiZuq5aDGD8SER4gp2PiNi/mIRr0KCmy2itYhPQtxJ3Sc01Xv/o+FK68uFJ6Mhg0bfv91IzsUdfEDEBzEefBDjARFjZ3zgmfi8wPhwNsg4dS9cjZFGoGcYH34Lcbzur0QMn9QlQoICxgdpIpuw899ETOG5GMpk6MiFOD4bPrgaM4vMZOioeiYsXGJSV9p5JB8DfK9WuFLkd8YN3Vpp3yP5DsaD3I1wXq2Q3/HBjkpca6recA0d34S4lJ3/pB9LzNk7Tw7jeJjD8HHwbNTgL8mPSuBbQuDA8S6fhJeO8NRFbAUCcJwLbnzJeScJcNcIWracVsgMDZlQH9dXRnZVc4RWHpk9Dg++JWfueuZ3BcFTO+LTGtcNre9QGOfOkkEIjvCjR2ZIXerBU4cTdzqoAka6YeG513UfsfKU3R2JMogBntoRhX7nxD6Ts/KU2TW4G4gFntuRx4BsH8lZBcrLnbrrubOaDKKdhbFf5KwC5Vw6shlcAjzf2jIPyJKrmsLbgVo/DZRv7siv4VJg2R/rbrLYYvfIseYmC7gWKLuvzivSZNjdtpy0oixzIU0CTQBlcpYR6YigAzYP0pAs4v6L1khhN5HIIQsfs/WPVHmL12lRgaXNSyPuJ21oVXVIaWqz6D81N3NS+hSO33uQNosWJtD7k7xG/qk+0NwkYdHtbRZ1br4WWnSDTatpvTL1Y9szlvbjRVDXRZcFMYQsUd4cv4BbAP3Ds2pbgwKEEHK8ofa+A8PD895cT+BKmIZYoP+dkMKYvUcR6PozKQWUhvAJjp9KqfpMCgVa80lhaJ9JcYHl48EO20felIa4aPtTTAmULU0vi8iJuolPMZG20UvrrdkH0ApaJcYFls9ZKRy/JGTnMK6Pn10Stt2NjocuP971B2OI6g1TdZYGAAAAAElFTkSuQmCC",Ct="/static/IdFrame-8312bac0.png";const wt=t=>{var V,H;console.log(t);const a=ue(),{applayCardDraftDataJumio:d,channelApplyNo:o}=U(w=>w.cardApply);U(w=>w.user);const m=document.querySelector(".pagebox");(V=m==null?void 0:m.style)==null||V.setProperty("--pagebox-bg","transparent");const F=(H=Ve().state)==null?void 0:H.certificate,[C,u]=y.useState(""),[x,i]=y.useState(""),[S,j]=y.useState(!1),[c,P]=y.useState(!1),L=window.screen.height/2;let p={x:0,y:150,width:window.screen.width,height:L,camera:CameraPreview.CAMERA_DIRECTION.BACK,toBack:!0,tapPhoto:!0,tapFocus:!1,previewDrag:!1,storeToFile:!1,disableExifHeaderStripping:!1};const J=()=>{CameraPreview.startCamera(p)};function A(w){return w.replace(/[^a-zA-Z0-9]/g,"").slice(0,32)}function R(w,f){const O=w,k=new ArrayBuffer(O.length),G=new Uint8Array(k);for(let z=0;z<O.length;z++)G[z]=O.charCodeAt(z);return new Blob([k],{type:f})}const v="image/jpeg",I=(w,f,O)=>ee(void 0,null,function*(){console.log("------------",w);try{const k=yield W("/dcs-apply-online/card/apply/fileUpload",{channelApplyNo:o,attachedType:"3",fileSuffix:f.split("/")[1],attachedName:O});return Pe.put(k.imageTempUrl,w,{headers:{"Content-Type":f}}),{key:O+Math.random(),url:URL.createObjectURL(w),extra:k.attachedImage}}catch(k){throw console.log("errr",k),new Error("error")}}),$=()=>{S||(a(Ne("")),CameraPreview.takePicture({width:640,height:640,quality:25},function(w){if(console.log("图片",w[0]),w.length<=0)return;const f=A(w[0])+".jpg";console.log("图片名称是什么",f);const O=R(w[0],v);i("data:image/jpeg;base64,"+w[0]),a(me("data:image/jpeg;base64,"+w[0])),j(!0),console.log("dcs-apply-online/card/apply/utils/externalOcr--------------------------",x),W("/dcs-apply-online/card/apply/utils/externalOcr",{channelApplyNo:o,attachedType:"3",base64Image:w[0],ocrRequestType:"CHECK_ADDRESS",docType:C,attachedName:"dcs-apply-online/"+f}).then(k=>{if(a(D(!1)),a(pe(F)),j(!1),CameraPreview.stopCamera(),window.history.back(),console.log("certificate是什么",F,k),F==="CN"&&k.ocrAddressResult==="F"&&k.ocrIdentifyType==="CHINA_ID"){console.log("身份证验证失败");return}if(F==="CN"&&k.ocrAddressResult==="F"){I(O,"image/jpeg","image.jpg");return}if(F!=="CN"&&k.ocrAddressResult==="F"){I(O,"image/jpeg","image.jpg");return}a(Ne(k))}).catch(k=>{console.log("错误是什么",k),a(D(!0)),a(pe(F)),j(!1),CameraPreview.stopCamera(),window.history.back()})}))},T=()=>ee(void 0,null,function*(){a(D(!0)),yield CameraPreview.stopCamera(),window.history.back()});return console.log("afterRequest是什么123",c),y.useEffect(()=>(P(!1),a(me("")),F!="CN"?u(""):u("chinaIDcardFiles"),J(),()=>{a(pe(F)),CameraPreview.stopCamera(),m==null||m.style.setProperty("--pagebox-bg","rgb(255,255,255)")}),[]),y.useEffect(()=>()=>{c||a(D(!0))},[c]),r(B,{children:[e("div",{className:"pl-3 text-base",onClick:()=>{T()},children:e(Je,{color:"#FFF"})}),e("div",{className:"text-center text-[#FFF] mt-3",children:l("camera_desc")}),S?r("div",{style:{width:"100%",color:"#fff",position:"absolute",top:"50%",left:"0",textAlign:"center",fontSize:"16px"},children:[e(Xe,{color:"currentColor"}),e("span",{children:l("apply_guide_camera_successful")})]}):null,C==="chinaIDcardFiles"&&F=="CN"?e("div",{className:"w-full",style:{position:"relative",top:"150px"},children:e("div",{className:"mx-3 my-auto",children:e(de,{src:Ct})})}):null,r("div",{className:"h-52 w-full flex flex-col  items-center absolute bottom-0",children:[e("div",{className:"w-full h-12 mb-3",children:F=="CN"?r("div",{className:"w-36 h-10 my-3 mx-auto bg-[#000] text-[#FFF] flex justify-evenly items-center rounded",onClick:()=>u(C=="chinaIDcardFiles"?"chinaOtherFiles":"chinaIDcardFiles"),children:[e(de,{src:Nt,width:15}),C=="chinaIDcardFiles"?l("toogle_to_idcard_files"):l("toogle_to_other_files")]}):null}),e(q,{onClick:()=>{P(!0),$()},className:"PhotoBtn rounded-full",children:e(de,{src:At})})]})]})},Bt=y.memo(()=>{const t=Ae(),a=ue(),[d]=_.useForm();Ve();const[o]=et(),m=tt(),{userInfo:n,sdkData:F}=U(N=>N.user),{appliedCardsFlat:C,channelApplyNo:u,applyExtraParms:x,appliedCards:i,applayCardDraftDataJumio:S,jumioWorkflowData:j,jumioInfoData:c,addressInformationIsDisplayed:P,residentialAddressInfo:L,postcodeGetAddress:p,addressCcertificate:J}=U(N=>N.cardApply),A=U(N=>N.app.locale),[R,v]=y.useState(),[I,$]=y.useState(parseInt(m.id||"")),[T,V]=y.useState(!0),[H,w]=y.useState(!1),[f,O]=y.useState(!1),[k,G]=y.useState(""),z=y.useMemo(()=>{var N;return i[0]&&((N=i[0].productList[0])==null?void 0:N.tenCardsFlag)},[i]),te=(N,g)=>(d.setFieldValue("otp",N),d.setFieldValue("otpPrefix",g),Q(d.getFieldsValue(!0),!0));y.useEffect(()=>{P&&(console.log("赋值地址",P),d.setFieldsValue({residentAddress:{line1:(P==null?void 0:P.ocrAddressInfoEN)||""}}))},[P]),y.useEffect(()=>{console.log("子组件设置居住地址",L),d.setFieldsValue({residentAddress:{block:(L==null?void 0:L.building_number)||"",street:(L==null?void 0:L.street)||"",building:(L==null?void 0:L.building_name)||""}})},[L]),y.useEffect(()=>{console.log("子组件设置邮件地址",p),d.setFieldsValue({billingAddress:{block:(p==null?void 0:p.building_number)||"",street:(p==null?void 0:p.street)||"",building:(p==null?void 0:p.building_name)||""}})},[p]);const Q=(N,g)=>ee(void 0,null,function*(){console.log("llllllllllllllllllllllllllllllllllllll",N),w(!0);const h=he(re({stepNo:I+1,channelApplyNo:j==null?void 0:j.applyNo,myinfoApplyNo:"",applicationType:4,cardAndProductList:C,mobile:void 0,orgCode:n==null?void 0:n.orgCode},ae(I,N)),{cardSdkExternalParam:F});let ne=(n==null?void 0:n.areaCode)+" "+(n==null?void 0:n.phoneNumber);if(!g&&h.stepNo===1&&h.mobile!==ne)return h.mobile&&G(h.mobile),w(!1),O(!0);G(ne),console.log("缓存数据前",h);try{const X=yield W("/dcs-apply-online/card/apply/login/saveApplication/jumio",h);if(!X)return;if(X.applyCardsFlag){v(X.applyCards);return}if(v(void 0),O(!1),a(lt(X.channelApplyNo)),h.stepNo===6)yield W("/dcs-apply-online/card/apply/login/sumbitApplication/v5",he(re({},x),{jumioAccountId:c==null?void 0:c.accountId,jumioWorkflowExecutionId:c==null?void 0:c.workflowId,channelApplyNo:u,myinfoApplyNo:"",applicationType:4})),t("/result-page",{replace:!0});else{const{back:_e}=Object.fromEntries(o.entries());if(_e)return t(-1);if(console.log("顺序调整确认",I,m.id),h.stepNo===12)return;console.log("相机页面怎么样","1"+h.stepNo,"2"+I,"3"+m.id),I===1?t("/jumio/2-1"):m.id=="2-1"||m.id=="2-2"?N.yearsWorking?t("/jumio/2-2"):t("/jumio/3"):t(`/jumio/${I+1}`)}}catch(X){return Promise.reject()}finally{w(!1)}}),le=()=>ee(void 0,null,function*(){V(!0),console.log("init - channelApplyNo",u);let N=re({},S);try{if(!u&&I===0){const g=yield W("/dcs-apply-online/card/apply/login/queryLastestApplication",{applicationType:4});g!=null&&g.channelApplyNo?N=yield W("/dcs-apply-online/card/apply/login/queryApplicationbyStep/v4",{channelApplyNo:g.channelApplyNo,myinfoApplyNo:"",applicationType:4,cardAndProductList:C}):N.mobile=`${n==null?void 0:n.areaCode} ${n==null?void 0:n.phoneNumber}`}else if(u){const g=yield W("/dcs-apply-online/card/apply/login/queryApplicationbyStep/v4",{channelApplyNo:u,myinfoApplyNo:"",applicationType:4,cardAndProductList:C});N=Object.assign(N,g),console.log("form数据怎样回显",N,g,P)}}catch(g){}return V(!1),N.residentialStatus=N.residentialStatus||(A==="en-SG"?"C":"A"),N.isAlien=["C","P"].includes(N.residentialStatus||"")?"1":"0",console.log("获取到的数据",N),a(at(N)),N}),ae=(N,g)=>{var ne,X,_e,Ce,we,Fe,Se,Oe,ke;const h=re({},g);return console.log("urlParams.id========="+m.id,S),console.log("stepNo========="+N),console.log("isHundred========="+z),console.log("value =========",g),Object.keys(g).forEach(Z=>{g[Z]&&typeof g[Z]=="string"&&Z!="otpPrefix"&&(h[Z]=g[Z].toLocaleUpperCase())}),N===0?(a(pe(void 0)),a(me("")),console.log("这里还有照片吗",J),a(D(!0)),h.cardIssuer="G",h.salesStaff=(x==null?void 0:x.staff_id)||"",h.location=(x==null?void 0:x.location)||"",h.mobile=`${g.mobile.areaCode} ${g.mobile.phone}`,h.residentialStatus="A",h.passport=((ne=c==null?void 0:c.idResult)==null?void 0:ne.idNumber)||"",h.custName=(X=c==null?void 0:c.idResult)!=null&&X.firstName?((_e=c==null?void 0:c.idResult)==null?void 0:_e.lastName)+" "+((Ce=c==null?void 0:c.idResult)==null?void 0:Ce.firstName):"",h.birthDate=(we=c==null?void 0:c.idResult)==null?void 0:we.dateOfBirth,h.jumioAccountId=c==null?void 0:c.accountId,h.jumioWorkflowExecutionId=c==null?void 0:c.workflowId,h.nationality=(Fe=c==null?void 0:c.idResult)==null?void 0:Fe.nationality,h.gender=(Se=c==null?void 0:c.idResult)==null?void 0:Se.gender,h.nationality=(Oe=c==null?void 0:c.idResult)==null?void 0:Oe.nationality,h.passportExpiryDate=(ke=c==null?void 0:c.idResult)==null?void 0:ke.expiryDate,h.jumioSdkIdResult=Object.assign({},c==null?void 0:c.idResult,{idType:"PASSPORT"}),h.jumioSdkFaceResult=c==null?void 0:c.faceResult):N===1?(console.log("第1步"),g.billingAddress.country||(h.billingAddress=he(re({},g.billingAddress),{country:"SG"})),h.sameResidentialFlag="N"):N===2?(g.yearsWorking?(console.log("-------------2-1",JSON.stringify(g)),h.incomeYear=Ft(g.incomeYear),h.selfEmployment=g.selfEmployment?"Y":"N",h.serviceYears=g.yearsWorking[0],h.serviceMonths=g.yearsWorking[1],h.empPassExpiryDate=xe(g.passportExpiryDate).format("YYYY-MM-DD"),h.stepNo=3):(console.log("-------------2-2",JSON.stringify(g)),console.log(">>>>",JSON.stringify(h)),Object.keys(g).forEach(Z=>{Array.isArray(g[Z])&&(h[Z]=g[Z].map(Ue=>Ue.extra))}),h.stepNo=4),g.jobSeniorityList&&(h.jobSeniorityList=[g.jobSeniorityList]),g.purposeOfAccountList&&(h.purposeOfAccountList=[g.purposeOfAccountList]),g.sourceOfFundsCountryList&&(h.sourceOfFundsCountryList=[g.sourceOfFundsCountryList])):N===3?(h.stepNo=5,z?(h.determineLimitFlag="Y",h.preCreditLimit=100*1e3):h.preCreditLimit=g.preCreditLimit*1e3*100):N===4?(console.log("第四步"),h.pdpaFlag=g.pdpaFlag?"Y":"N",h.usaTaxResident=g.usaTaxResident?"Y":"N",h.dncFlag=g.dncFlag?"Y":"N",h.stepNo=6):N===5?console.log("第5步"):N===6&&console.log("第6步"),console.log("改变的数据后",h),h};return y.useEffect(()=>{console.log("urlParams===>",JSON.stringify(m)),a(be(!1)),le(),m.id&&$(parseInt(m.id))},[m]),r("div",{children:[I<4&&r(oe,{current:I,className:"bg-white ",children:[e(oe.Step,{title:l("apply_upgrade_personal_info")}),e(oe.Step,{title:l("apply_upgrade_address_info")}),e(oe.Step,{title:l("apply_upgrade_other_info")}),e(oe.Step,{title:l("apply_form_card_personalization")})]}),I===12?e(wt,{}):e(_,{className:"m-3 border-0 mb-10",form:d,onFinish:Q,requiredMarkStyle:"text-optional",footer:I===12?null:e(q,{block:!0,type:"submit",color:"primary",size:"large",shape:"rounded",loading:H,children:e(s,{id:I===6?"common_submit":"common_next"})}),children:T?e(rt.Paragraph,{lineCount:20,animated:!0}):r(B,{children:[I===0&&e(mt,{}),I===1&&e(xt,{}),m.id==="2-1"&&e(ht,{}),m.id==="2-2"&&e(bt,{}),I===3&&e(ft,{}),I===4&&e(ut,{})]})}),e(nt,{show:f,onConfirm:te,phone:k,onClose:()=>O(!1)}),e(ct,{open:!0,setOpen:()=>null,applyCards:R,onOk:()=>Q(d.getFieldsValue(!0),!0)})]})}),Ft=t=>{if(t)return`${parseInt(`${(Number(t)||0)*100}`)}`};export{Bt as default};
