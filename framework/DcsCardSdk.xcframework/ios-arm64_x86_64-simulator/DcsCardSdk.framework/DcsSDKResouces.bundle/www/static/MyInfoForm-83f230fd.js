var be=Object.defineProperty,ye=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var le=(t,r,n)=>r in t?be(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,$=(t,r)=>{for(var n in r||(r={}))we.call(r,n)&&le(t,n,r[n]);if(ie)for(var n of ie(r))Ce.call(r,n)&&le(t,n,r[n]);return t},z=(t,r)=>ye(t,ge(r));var J=(t,r,n)=>new Promise((h,x)=>{var u=p=>{try{_(n.next(p))}catch(b){x(b)}},E=p=>{try{_(n.throw(p))}catch(b){x(b)}},_=p=>p.done?h(p.value):Promise.resolve(p.value).then(u,E);_((n=n.apply(t,r)).next())});import{r as w,u as O,e,j as s,a0 as v,a1 as k,F as m,k as R,f as i,I as A,g as l,K as a,J as L,b as pe,B as T,a2 as me,a3 as Ae,h as ve,a as Se,O as je,M as ke,$ as Fe,t as Y,R as Oe,p as Ee,Q as ae,P as ne,a4 as q,S as Pe}from"./index-6701bc4a.js";import{D as Le,S as $e,F as Re}from"./myinfoform-ac8901f5.js";import{M as _e}from"./OTPInputPanel-c703fb99.js";import{C as g}from"./card-0f9563e7.js";import{D as Te}from"./index-5411defb.js";import{D as Me}from"./divider-0fbf94b9.js";import{C as B}from"./index-87da04c9.js";import{R as M}from"./index-c76bae8d.js";import"./search-bar-8ae064c9.js";import"./native-input-f54745c8.js";const Ve=w.memo(()=>{const t=O(n=>n.cardApply);let r=$({},t.myInfoData);return r==null||delete r.passexpirydate,O(n=>n.user),console.log("9898098",r),!r||Object.keys(r).length==0?e(R,{}):s(g,{title:e(i,{id:"apply_form_personal_info"}),className:"p-0 rounded-lg",headerClassName:"px-5",children:[s(v,{direction:"vertical",block:!0,className:"px-5",children:[s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_name"}),e("span",{className:"font-bold",children:r==null?void 0:r.custName})]}),(r==null?void 0:r.aliasName)&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_alias_name"}),e("span",{className:"font-bold",children:r==null?void 0:r.aliasName})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_gender"}),e("span",{className:"font-bold",children:k("GENDER",r==null?void 0:r.gender)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_date_of_birth"}),e("span",{className:"font-bold",children:e(L,{value:r==null?void 0:r.birthDate})})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_nationality"}),e("span",{className:"font-bold",children:k("COUNTRY_CODE_ISO2",r==null?void 0:r.nationality)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_NRIC_FIN"}),e("span",{className:"font-bold",children:r==null?void 0:r.icNumber})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_your_country"}),e("span",{className:"font-bold",children:k("COUNTRY_CODE_ISO2",r==null?void 0:r.countryOfBirth)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_maritial_status"}),e("span",{className:"font-bold",children:k("MARITAL_STATUS",r==null?void 0:r.maritalStatus)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_race"}),e("span",{className:"font-bold",children:(r==null?void 0:r.race)||"-"})]}),(r==null?void 0:r.residentialStatus)&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_residential_status"}),e("span",{className:"font-bold",children:k("RESIDENTIAL_STATUS_MYINFO",r==null?void 0:r.residentialStatus)})]}),r!=null&&r.mobile?s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor",id:"apply_form_mobile_phone"}),e("span",{className:"font-bold",children:(r==null?void 0:r.mobile)||"-"})]}):null]}),e(Me,{className:"mt-8"}),s("div",{className:"px-5",children:[!r.mobile&&e(m.Item,{name:"mobile",label:e(i,{id:"apply_form_mobile_phone"}),rules:[{required:!0,validator:(n,h)=>{if(h!=null&&h.phone){if(h.areaCode==="+65"&&!/^[0-9]{8}$/.test(h.phone))return Promise.reject(l("rule_digits",{string:"8"}));if(h.areaCode==="+86"&&!/^[0-9]{11}$/.test(h.phone))return Promise.reject(l("rule_digits",{string:"11"}));if(!/^[0-9]{8,20}$/.test(h.phone))return Promise.reject(l("rule_digits",{string:"8-20"}))}return Promise.resolve()}}],children:e(_e,{})}),r.isAlien!=="1"&&s(R,{children:[e(m.Item,{name:"passport",label:e(i,{id:"apply_form_passport_num"}),initialValue:r==null?void 0:r.passport,children:e(A,{maxLength:32,placeholder:l("apply_form_please_enter")+l("apply_form_passport_num")})}),e(m.Item,{name:"passportExpiryDate",label:e(i,{id:"apply_form_passport_expiry_date"}),trigger:"onConfirm",onClick:(n,h)=>{var x;(x=h.current)==null||x.open()},initialValue:r!=null&&r.passexpirydate?new Date(r==null?void 0:r.passexpirydate):void 0,children:e(Te,{children:n=>e("div",{className:`adm-input ${n?"text-default":"text-minor"}`,children:n?e(L,{value:n}):l("apply_form_please_enter")+l("apply_form_passport_expiry_date")})})})]}),e(m.Item,{name:"email",label:e(i,{id:"apply_form_email"}),initialValue:r.email,rules:[{required:!0},{type:"email"}],children:e(A,{autoCapitalize:"",className:"uppercase",placeholder:l("apply_form_please_enter")+l("apply_form_email"),maxLength:320})})]})]})}),Ue=w.memo(()=>{var x,u,E;const{myInfoData:t,appliedCards:r}=O(_=>_.cardApply);O(_=>_.user);const n=pe(),h=w.useMemo(()=>({0:l("status_submitted"),1:l("status_processing"),2:l("status_approved"),3:l("status_supporting_documents"),4:l("status_rejected"),5:l("status_cancel")}),[]);return!t||!r[0]||Object.keys(t).length==0?e(R,{}):(console.log("myInfoData.passportVerificationStatus",t.passportVerificationStatus,h[t.passportVerificationStatus]),(x=r[0].productList[0])!=null&&x.tenCardsFlag,s(v,{direction:"vertical",block:!0,children:[e(g,{title:s("div",{className:"flex justify-between items-center text-sm",children:[e(i,{id:"apply_form_declaration_particulars"}),e(T,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{n("/myinfo/1?back=true")},children:e(i,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg",headerClassName:"px-5",children:s(v,{direction:"vertical",block:!0,className:"px-5",children:[s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_name"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.custName})]}),t.aliasName&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_alias_name"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.aliasName})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_gender"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:k("GENDER",t.gender)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_date_of_birth"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:e(L,{value:t.birthDate})})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_nationality"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:k("COUNTRY_CODE_ISO2",t.nationality)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_NRIC_FIN"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.icNumber})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_your_country"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:k("COUNTRY_CODE_ISO2",t.countryOfBirth)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_maritial_status"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:k("MARITAL_STATUS",t.maritalStatus)})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_race"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.race||"-"})]}),t.residentialStatus&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_residential_status"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:k("RESIDENTIAL_STATUS_MYINFO",t.residentialStatus)})]}),t.passport&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_passport_num"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.passport})]}),t.passportExpiryDate&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_passport_expiry_date"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:e(L,{value:t.passportExpiryDate})})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_mobile_phone"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.mobile||"-"})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_email"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:t.email||"-"})]})]})}),e(g,{title:s("div",{className:"flex justify-between items-center text-sm",children:[e(i,{id:"apply_form_residence_details"}),e(T,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{n("/myinfo/2?back=true")},children:e(i,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:s(v,{direction:"vertical",block:!0,className:"px-5",children:[t.residentAddress&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_proOwnStatus"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.proOwnStatus})]}),((u=t.residentAddress)==null?void 0:u.homePhone)&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_home_phone"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.residentAddress.homePhone})]}),t.residentAddress&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"common_address"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:de(t.residentAddress)})]})]})}),e(g,{title:s("div",{className:"flex justify-between items-center text-sm",children:[e(i,{id:"apply_form_mailing_addr"}),e(T,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{n("/myinfo/2?back=true")},children:e(i,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:e(v,{direction:"vertical",block:!0,className:"px-5 my-2",children:t.residentAddress&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"common_address"}),e("span",{className:"w-2/4 text-xs text-right break-words",children:de((E=t.billingAddress)!=null&&E.block?t.billingAddress:t.residentAddress)})]})})}),e(g,{title:e("div",{className:"flex justify-between items-center text-sm",children:e(i,{id:"apply_form_assessable_income"})}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:e("div",{className:"px-5",children:s("table",{border:1,cellPadding:9,className:"w-full text-center my-4 px-5",style:{background:"#F6F8FB"},children:[e("thead",{children:s("tr",{children:[e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_date"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_amount"})})]})}),e("tbody",{children:t==null?void 0:t.noahistoryBasics.map((_,p)=>s("tr",{children:[e("td",{className:"text-xs font-normal",children:_.yearofassessment}),e("td",{className:"text-xs font-normal",children:ce(_.amount/100,2)})]},p))})]})})}),e(g,{title:s("div",{className:"flex justify-between items-center text-sm",children:[e(i,{id:"apply_form_employment_details"}),e(T,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{n("/myinfo/3?back=true")},children:e(i,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:s(v,{direction:"vertical",block:!0,className:"px-5",children:[s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_self_employed"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.selfEmployment})]}),t.selfEmployment==="N"&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_employer_name"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.companyName})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_job_title"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:k("PROFESSION",t.profession)})]}),t.isAlien==="0"&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_type"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.passtype})]}),t.isAlien==="0"&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_status"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.passstatus})]}),t.isAlien==="0"&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_maturity_time"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:e(L,{value:t.passexpirydate})})]}),t.isAlien==="0"&&s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_department"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.employmentsector})]})]})}),(t==null?void 0:t.cpfcontributions.length)!==0&&e(g,{title:e("div",{className:"flex justify-between items-center text-sm",children:e(i,{id:"apply_form_cpf_contribution"})}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:e("div",{className:"",children:s("table",{border:1,cellPadding:9,className:"w-full text-center my-4",style:{background:"#F6F8FB"},children:[e("thead",{children:s("tr",{children:[e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_contribution_onth"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_date"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_amount"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_emplyer"})})]})}),e("tbody",{children:t.cpfcontributions.map((_,p)=>s("tr",{children:[e("td",{className:"text-xs font-normal",children:e(me,{value:_.month})}),e("td",{className:"text-xs font-normal",children:e(L,{value:_.date})}),e("td",{className:"text-xs font-normal",children:ce(_.amount/100,2)}),e("td",{className:"text-xs font-normal",children:_.employer})]},p))})]})})}),e(g,{title:s("div",{className:"flex justify-between items-center text-sm",children:[e(i,{id:"apply_form_card_personalization"}),e(T,{color:"primary",fill:"none",className:"text-xs font-normal",onClick:()=>{n("/myinfo/4?back=true")},children:e(i,{id:"apply_form_declaration_edit"})})]}),className:"p-0 rounded-lg ",headerClassName:"px-5",children:s(v,{direction:"vertical",block:!0,className:"px-5",children:[s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_credit_lit_preference"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:(t==null?void 0:t.determineLimitFlag)==="N"?e(Ae,{value:Number(t.preCreditLimit),style:"currency",currency:"SGD"}):e(i,{id:"apply_form_let_dcs_determine"})})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_form_name_on_card"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:t.preNameOnCard})]})]})}),!!(t.isAlien==="0"&&t.passportVerificationStatus)&&e(g,{className:"p-0 rounded-lg px-5",children:s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"routeName_ID_Verification"}),e("span",{className:"w-2/4 text-xs text-right break-words capitalize",children:h[t.passportVerificationStatus]})]})}),e(g,{title:e("div",{className:"flex justify-between items-center text-sm",children:e(i,{id:"apply_form_consumer_advisory"})}),children:s("div",{className:"text-sm",children:[e("p",{children:l("apply_form_explain")}),s("p",{className:"mt-2",children:[l("apply_form_credit_bureau"),e("span",{className:"text-blue",children:"www.creditbureau.com.sg"})]}),s("p",{className:"",children:["● DP Credit Bureau Pte Ltd ",e("span",{className:"text-blue",children:"www.dpcreditbureau.sg"})]})]})}),e(g,{title:e("div",{children:e(i,{id:"apply_form_declaration_consent_title"})}),children:s(v,{direction:"vertical",block:!0,children:[e(m.Item,{name:"dncFlag",children:e(B,{children:l("apply_form_declaration_1a")})}),e(m.Item,{name:"usaTaxResident",children:e(B,{children:s("p",{children:[l("apply_form_declaration_3a"),e("br",{}),l("apply_form_declaration_3b"),e("br",{}),l("apply_form_declaration_3c")]})})}),e(m.Subscribe,{to:["usaTaxResident"],children:({usaTaxResident:_})=>{if(_)return e(m.Item,{label:e(i,{id:"apply_form_declaration_3d"}),name:"usaTaxTin",rules:[{required:!0},{pattern:/^[\w\s]{1,23}$/,message:l("rule_characters",{string:"1-23"})}],children:e(A,{maxLength:23,placeholder:l("apply_form_declaration_3e")})})}}),e(m.Item,{name:"pdpaFlag",rules:[{required:!0,message:l("apply_form_please_check")}],children:e(B,{children:s("p",{children:[e("span",{className:"text-red",children:"*"}),e(i,{id:"apply_form_authorization_text"}),e(i,{id:"apply_form_authorization_text2"}),e(i,{id:"apply_form_dcs_charge_credit1"}),e(i,{id:"apply_form_conditions"}),e(i,{id:"apply_form_application"})]})})})]})})]}))}),de=t=>{if(!t)return"-";if(t.country==="SG")return`${t.block} ${t.street} # ${t.floor}-${t.unit} ${t.building||"-"} ${t.country} (${t.postal})`;if(t!=null&&t.line1)return`${t.line1} ${t==null?void 0:t.line2}`};function ce(t,r){return t?t.toFixed(r).toString().toLocaleString():"0"}const ze=w.memo(()=>{let{myInfoData:t}=O(r=>r.cardApply);return!t||Object.keys(t).length==0?e(R,{}):s(g,{headerClassName:"px-5",title:s("div",{children:[e(a,{id:"apply_form_assessable_income"}),s("table",{border:1,cellPadding:9,className:"w-full text-center my-4",style:{background:"#F6F8FB"},children:[e("thead",{children:s("tr",{children:[e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_date"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_amount"})})]})}),e("tbody",{children:t==null?void 0:t.noahistoryBasics.map((r,n)=>s("tr",{children:[e("td",{className:"text-xs font-normal",children:r.yearofassessment}),e("td",{className:"text-xs font-normal",children:oe(r.amount/100,2)})]},n))})]})]}),className:"p-0 rounded-lg",children:[s(v,{direction:"vertical",block:!0,className:"px-5",children:[e(a,{id:"apply_form_employment_details"}),e(m.Item,{name:"selfEmployment",rules:[{required:!0}],initialValue:t.selfEmployment==="Y",children:e(B,{defaultChecked:t.selfEmployment==="Y",children:e(i,{id:"apply_form_self_employed"})})}),e(m.Subscribe,{to:["selfEmployment"],children:({selfEmployment:r})=>{if(console.log("selfEmployment",r),!r)return e(m.Item,{name:"companyName",label:e(i,{id:"apply_form_employer_name"}),rules:[{required:!0}],initialValue:t.companyName,children:e(A,{maxLength:124,autoCapitalize:"characters",placeholder:l("apply_form_please_enter")+l("apply_form_employer_name")})})}}),e(m.Item,{name:"profession",label:e(i,{id:"apply_form_job_title"}),rules:[{required:!0}],initialValue:t.profession?[t.profession]:null,children:e(Le,{dictType:"PROFESSION",placeholder:l("apply_form_please_select_job_title")})}),(t==null?void 0:t.isAlien)==="0"&&s(v,{direction:"vertical",block:!0,children:[s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_occupation"}),e("span",{className:"font-bold text-sm text-right",children:t==null?void 0:t.occupation})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_type"}),e("span",{className:"font-bold text-sm text-right",children:t==null?void 0:t.passtype})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_status"}),e("span",{className:"font-bold text-sm text-right",children:t==null?void 0:t.passstatus})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_maturity_time"}),e("span",{className:"font-bold text-sm text-right",children:e(L,{value:t==null?void 0:t.passexpirydate})})]}),s("div",{className:"flex justify-between items-center",children:[e(a,{className:"text-minor text-xs",id:"apply_guide_work_department"}),e("span",{className:"font-bold text-sm text-right",children:t==null?void 0:t.employmentsector})]})]})]}),(t==null?void 0:t.cpfcontributions.length)!==0&&s("div",{className:"p-5 mt-5",style:{borderTop:"solid 0.5px var(--adm-color-border)"},children:[e(a,{id:"apply_form_cpf_contribution"}),s("table",{border:1,cellPadding:9,className:"w-full text-center my-4",style:{background:"#F6F8FB"},children:[e("thead",{children:s("tr",{children:[e("th",{className:"text-xs font-normal w-24",children:e(i,{id:"apply_form_contribution_onth"})}),e("th",{className:"text-xs font-normal w-28",children:e(i,{id:"apply_form_date"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_amount"})}),e("th",{className:"text-xs font-normal",children:e(i,{id:"apply_form_emplyer"})})]})}),e("tbody",{children:t==null?void 0:t.cpfcontributions.map((r,n)=>s("tr",{children:[e("td",{className:"text-xs font-normal",children:e(me,{value:r.month})}),e("td",{className:"text-xs font-normal",children:e(L,{value:r.date})}),e("td",{className:"text-xs font-normal",children:oe(r.amount/100,2)}),e("td",{className:"text-xs font-normal",children:r.employer})]},n))})]})]})]})});function oe(t,r){return t?t.toFixed(r).toString().toLocaleString():"0"}const Ye=w.memo(()=>{var _;const t=O(p=>p.user),{myInfoData:r,appliedCards:n}=O(p=>p.cardApply),h=n[0]&&((_=n[0].productList[0])==null?void 0:_.fixedLimit)==="1",[x,u]=w.useState(r==null?void 0:r.preNameOnCard);if(w.useState(!1),w.useEffect(()=>{u(r.preNameOnCard)},[r.preNameOnCard]),!r||Object.keys(r).length==0)return e(R,{});const E=p=>{u(p.toLocaleUpperCase())};return console.log("appliedCards",JSON.stringify(x),JSON.stringify(r)),s("div",{children:[!h&&e(g,{headerClassName:"px-5",title:e("div",{children:e(a,{id:"apply_form_credit_lit_preference"})}),className:"p-0 rounded-lg",children:s(v,{direction:"vertical",block:!0,className:"px-5",children:[e(m.Item,{name:"determineLimitFlag",rules:[{required:!0}],initialValue:"Y",children:e(M.Group,{children:s(v,{direction:"vertical",children:[e(M,{value:"Y",children:e(i,{id:"apply_form_let_dcs_determine"})}),e(M,{value:"N",children:e(i,{id:"apply_form_set_my_preferred_limit"})})]})})}),e(m.Subscribe,{to:["determineLimitFlag"],children:({determineLimitFlag:p})=>{if(p!=="Y")return s("div",{className:"mt-10",children:[e(m.Item,{name:"preCreditLimit",rules:[{required:!0}],initialValue:1,children:e($e,{residentPopover:!0,step:1,max:150,min:1,popover:b=>e("span",{children:b*1e3}),icon:e(qe,{})})}),s("div",{className:"flex justify-between text-xs",children:[e("span",{children:"S$ 1,000"}),e("span",{children:"S$ 150,000"})]}),e(a,{className:"text-xs text-minor mx-6 my-6 text-center",id:"apply_form_credit_limit_tip"})]})}})]})}),e(g,{headerClassName:"px-5 ",title:e("div",{children:e(a,{id:"apply_form_name_on_card"})}),className:"p-0 rounded-lg mt-4",children:s("div",{className:"px-5",children:[e(m.Item,{name:"preNameOnCard",label:e(i,{id:"apply_form_embossed_name"}),rules:[{required:!0},{pattern:/^[A-Za-z ]*$/,message:l("rule_alphabets_spaces")}],initialValue:r==null?void 0:r.preNameOnCard,children:e(A,{autoCapitalize:"characters",maxLength:19,minLength:2,onChange:E})}),n.map(p=>{let b=t.sdkData.productInfo.find(G=>G.productCode===p.productList[0].productCode);return console.log("sdkDataItem",b,p.channelCardShowImage),s("div",{className:"mt-5 relative",children:[e(ve,{src:b&&b.cardFace?b.cardFace:p.channelCardShowImage,alt:p.channelCardName}),e("span",{style:{position:"absolute",bottom:0,left:0},className:"text-base font-medium text-white pl-5 pb-5",children:t!=null&&t.showCardNameMaskOnCardFlag?x:""})]},p.channelCreditCardId)}),e("p",{className:"text-minor text-xs text-left mt-2",children:e(i,{id:"apply_guide_embossed_tip"})})]})})]})}),qe=()=>s("svg",{width:"38",height:"18",viewBox:"0 0 38 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"0.5",y:"0.5",width:"37",height:"17",rx:"8.5",fill:"#3366FF",stroke:"#E3FAFF"}),e("rect",{x:"16",y:"4",width:"10",height:"2",rx:"1",transform:"rotate(90 16 4)",fill:"#ACF0FF"}),e("rect",{x:"20",y:"4",width:"10",height:"2",rx:"1",transform:"rotate(90 20 4)",fill:"#ACF0FF"}),e("rect",{x:"24",y:"4",width:"10",height:"2",rx:"1",transform:"rotate(90 24 4)",fill:"#ACF0FF"})]}),Be=t=>{var n,h;const{myInfoData:r}=O(x=>x.cardApply);return!r||Object.keys(r).length==0?e(R,{}):s("div",{style:{background:"rgb(246, 248, 251)"},children:[e(g,{title:e(i,{id:"apply_form_residence_details"}),className:"p-0 rounded-lg",headerClassName:"px-5",children:s("div",{className:"px-5",children:[e("p",{className:"font-bold text-base my-2",children:Ge(r==null?void 0:r.residentAddress)}),e(m.Item,{name:"proOwnStatus",label:e(i,{id:"apply_form_proOwnStatus"}),initialValue:(r==null?void 0:r.proOwnStatus)||"False",rules:[{required:!0}],children:e(A,{disabled:!0,placeholder:l("apply_form_please_enter")+l("apply_form_proOwnStatus")})}),e(m.Item,{name:"homePhone",label:e(i,{id:"apply_form_home_phone_optional"}),rules:[{validator:(x,u)=>{if(u!=null&&u.phone){if(u.areaCode==="+65"&&!/^[0-9]{8}$/.test(u.phone))return Promise.reject(l("rule_digits",{string:"8"}));if(u.areaCode==="+86"&&!/^[0-9]{11}$/.test(u.phone))return Promise.reject(l("rule_digits",{string:"11"}));if(!/^[0-9]{5,20}$/.test(u.phone))return Promise.reject(l("rule_digits",{string:"5-20"}))}return Promise.resolve()}}],initialValue:{areaCode:((n=r==null?void 0:r.residentAddress.homePhone)==null?void 0:n.split(" ")[0])||"+65",phone:((h=r==null?void 0:r.residentAddress.homePhone)==null?void 0:h.split(" ")[1])||""},children:e(_e,{})})]})}),e(g,{title:e(i,{id:"apply_form_mailing_addr"}),className:"p-0 rounded-lg mt-4",headerClassName:"px-5",children:s("div",{className:"px-5",children:[e(m.Item,{initialValue:(r==null?void 0:r.sameResidentialFlag)||"Y",name:"sameResidentialFlag",required:!0,children:e(M.Group,{children:s(v,{children:[e(M,{value:"Y",children:e(i,{id:"apply_form_singapore_address"})}),e(M,{value:"N",children:e(i,{id:"another_mailing_address"})})]})})}),e(m.Subscribe,{to:["sameResidentialFlag"],children:({sameResidentialFlag:x})=>{if(console.log("sameResidentialFlag",x),x!=="Y")return s(R,{children:[e(m.Item,{name:["billingAddress","block"],label:e(i,{id:"apply_form_block"}),rules:[{required:!0},{pattern:/^[\w\s]{1,10}$/,message:l("rule_characters",{string:"1-10"})}],initialValue:r==null?void 0:r.residentAddress.block,children:e(A,{placeholder:l("apply_form_please_enter")+l("apply_form_block")})}),e(m.Item,{name:["billingAddress","building"],label:e(i,{id:"apply_form_building"}),rules:[{pattern:/^[\w\s]{1,66}$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:r==null?void 0:r.residentAddress.building,children:e(A,{placeholder:l("apply_form_please_enter")+l("apply_form_building")})}),e(m.Item,{name:["billingAddress","floor"],label:e(i,{id:"apply_form_floor"}),help:e(i,{id:"apply_form_floor_tips"}),rules:[{required:!0},{pattern:/^[A-Za-z0-9]{1,5}$/,message:l("rule_characters",{string:"1-5"})}],initialValue:r==null?void 0:r.residentAddress.floor,children:e(A,{placeholder:l("apply_form_please_enter")+l("apply_form_floor")})}),e(m.Item,{name:["billingAddress","unit"],label:e(i,{id:"apply_form_unit"}),rules:[{required:!0},{pattern:/^[0-9]{1,5}$/,message:l("rule_digits",{string:"1-5"})}],help:e(i,{id:"apply_form_unit_tips"}),initialValue:r==null?void 0:r.residentAddress.unit,children:e(A,{placeholder:l("apply_form_please_enter")+l("apply_form_unit")})}),e(m.Item,{name:["billingAddress","street"],label:e(i,{id:"apply_form_street_name"}),rules:[{required:!0},{pattern:/^[\w\s]{1,66}$/,message:l("rule_alphabets_numbers_spaces")}],initialValue:r==null?void 0:r.residentAddress.street,children:e(A,{placeholder:l("apply_form_please_enter")+l("apply_form_street_name")})}),e(m.Item,{name:["billingAddress","postal"],label:e(i,{id:"apply_form_postal_code"}),rules:[{required:!0},{pattern:/^[a-zA-Z0-9]*$/,message:l("rule_alphabets_numbers")}],initialValue:r==null?void 0:r.residentAddress.postal,normalize:u=>u==null?void 0:u.toUpperCase(),children:e(A,{maxLength:6,placeholder:l("apply_form_please_enter")+l("apply_form_postal_code")})}),e(m.Item,{name:["billingAddress","country"],label:e(i,{id:"apply_form_country"}),rules:[{required:!0}],initialValue:"SINGAPORE",children:e(A,{disabled:!0,placeholder:l("apply_form_please_enter")+l("apply_form_country")})})]})}})]})})]})},Ge=t=>{if(!t)return"-";if(t.country==="SG")return`${t.block} ${t.street} # ${t.floor}-${t.unit} ${t.building||"-"} ${t.country} (${t.postal})`;if(t!=null&&t.line1)return`${t.line1} ${t==null?void 0:t.line2}`},st=()=>{const t=pe(),r=Se(),[n]=m.useForm();je();const[h]=ke(),x=Fe(),[u,E]=w.useState(),{appliedCardsFlat:_,channelApplyNo:p,myinfoApplyNo:b,applyExtraParms:G,myInfoData:f,jumioInfoData:j}=O(N=>N.cardApply),[C,he]=w.useState(Number(x.id)),[H,K]=w.useState(!1),[ue,S]=w.useState(!1),[xe,W]=w.useState(!1),{userInfo:P,sdkData:d,identityCheckFlag:y,applyPhoneNumberflag:Ze}=O(N=>N.user),fe=()=>J(void 0,null,function*(){const{code:N,state:c,error:o}=Object.fromEntries(h.entries());if(o)return t(-1);if(console.log(">>>>",N,b,H),N&&!b&&!H)try{const F=yield Y("/dcs-apply-online/myinfo/thirdParty/callback/v2",{code:N,state:c});K(!0),r(ae(F.myinfoApplyNo)),yield Q(F.myinfoApplyNo)}catch(F){console.log("----------",F),K(!0)}finally{S(!1)}else b&&(yield Q(b),S(!1))}),Q=N=>J(void 0,null,function*(){var I,D,ee,te,re,se;N&&r(ae(N)),S(!0),r(ne({}));const c=yield Y("/dcs-apply-online/card/apply/login/queryApplicationbyStep/v4",{myinfoApplyNo:N||b,channelApplyNo:p,applicationType:2,cardAndProductList:_});if(S(!1),!c)return;console.log("identityCheckFlag",y);let o=c.appIdType.toUpperCase(),F=c.icNumber.toUpperCase(),V=c.birthDate.toUpperCase(),U=c.gender.toUpperCase(),Z=c.custName.toUpperCase();if((y!=null&&y.includes("idType")||y!=null&&y.includes("idNo"))&&(o!=((I=d==null?void 0:d.idType)==null?void 0:I.toUpperCase())||F!=((D=d==null?void 0:d.idNo)==null?void 0:D.toUpperCase()))){q.show(l("user_identities_do_not_match")),console.log("需要交叉验证idtype idNo",o,F,d==null?void 0:d.idType,d==null?void 0:d.idNo),t(-1);return}if(y!=null&&y.includes("birthDate")&&V.replace(/-/g,"")!=((ee=d==null?void 0:d.birthDate)==null?void 0:ee.toUpperCase())){q.show(l("user_identities_do_not_match")),console.log("需要交叉验证birthDate",V,d==null?void 0:d.birthDate),t(-1);return}if(y!=null&&y.includes("gender")&&U!=((te=d==null?void 0:d.gender)==null?void 0:te.toUpperCase())){q.show(l("user_identities_do_not_match")),console.log("需要交叉验证性别",U,d==null?void 0:d.gender),t(-1);return}if((y!=null&&y.includes("firstName")||y!=null&&y.includes("lastName"))&&!(Z.includes((re=d==null?void 0:d.firstName)==null?void 0:re.toUpperCase())&&Z.includes((se=d==null?void 0:d.lastName)==null?void 0:se.toUpperCase()))){q.show(l("user_identities_do_not_match")),console.log("需要交叉验证姓名",Z,d==null?void 0:d.firstName,d==null?void 0:d.lastName),t(-1);return}c!=null&&c.mobile?W(!0):(W(!1),c.mobile=(P==null?void 0:P.areaCode)+" "+(P==null?void 0:P.phoneNumber)),c.preCreditLimit=((c==null?void 0:c.preCreditLimit)||0)/100,r(ne(c))}),X=w.useCallback(N=>(S(!0),console.log("onFinish",_),Y("/dcs-apply-online/card/apply/login/saveApplication/myinfo/v4",z($({},Ne(C,N)),{stepNo:{4:5,5:6}[C]||C,orgCode:P==null?void 0:P.orgCode,channelApplyNo:p,myinfoApplyNo:b,cardAndProductList:_,cardSdkExternalParam:d,pageType:{1:"BASE_INFO",2:"ADDRESS_INFO",3:"WORK_INFO",4:"CARD_PERSONALIZE",5:"CARD_PERSONALIZE",6:"CARD_PERSONALIZE"}[C]})).then(c=>{if(c.applyCardsFlag){E(c.applyCards),S(!1);return}if(E(void 0),r(Oe(c.channelApplyNo)),C===3&&(f==null?void 0:f.isAlien)!=="1"&&(j==null?void 0:j.isSuccess)!=="1"){S(!1),t("/ApplyIDVerification");return}if(C===5)console.log("第五部",j),Y("/dcs-apply-online/card/apply/login/sumbitApplication/v5",z($({},G),{channelApplyNo:p,myinfoApplyNo:b,applicationType:2,jumioAccountId:j==null?void 0:j.accountId,jumioWorkflowExecutionId:j==null?void 0:j.workflowId})).then(()=>{t("/result-page",{replace:!0})}).finally(()=>{S(!1)});else{S(!1);const{back:o}=Object.fromEntries(h.entries());if(o)return t(-1);t(`/myinfo/${C+1}`)}}).catch(()=>{S(!1)})),[C,b,p,_,f,j]),Ne=(N,c)=>{var F,V,U;const o=$({},c);return N===1&&(o.cardIssuer="G",o.passportExpiryDate&&(o.passportExpiryDate=Ee(c.passexpirydate).format("YYYY-MM-DD")),o.email=o.email.toLocaleUpperCase(),xe||(o.mobile=f==null?void 0:f.mobile),typeof o.mobile=="object"&&(o.mobile=o.mobile.areaCode+" "+o.mobile.phone)),N===2&&(o.appResidencyCode="SG",(F=c.homePhone)!=null&&F.phone?o.residentAddress=z($({},f==null?void 0:f.residentAddress),{homePhone:`${(V=c.homePhone)==null?void 0:V.areaCode} ${(U=c.homePhone)==null?void 0:U.phone}`}):o.residentAddress=f==null?void 0:f.residentAddress,o.billingAddress=z($({},o.billingAddress?o.billingAddress:f==null?void 0:f.residentAddress),{country:(f==null?void 0:f.residentAddress.country)||"SG"}),delete o.homePhone),N===3&&(console.log("selfEmployment",c.selfEmployment),o.selfEmployment=c.selfEmployment?"Y":"N"),N===4&&(o.preCreditLimit=(c.preCreditLimit||0)*1e3,o.determineLimitFlag=c.determineLimitFlag||"Y",o.preNameOnCard=c.preNameOnCard.toLocaleUpperCase()),N===5&&(o.pdpaFlag=c.pdpaFlag?"Y":"N",o.usaTaxResident=c.usaTaxResident?"Y":"N",o.dncFlag=c.dncFlag?"Y":"N"),o};return w.useEffect(()=>{try{S(!0),fe()}catch(N){S(!1),t(-1)}he(Number(x.id))},[x]),s("div",{children:[!f&&e(Pe,{}),s(m,{className:"p-3 mb-10",form:n,onFinish:X,requiredMarkStyle:"text-optional",footer:e(T,{block:!0,type:"submit",color:"primary",size:"large",shape:"rounded",loading:ue,children:e(i,{id:C===5?"common_submit":"common_next"})}),children:[C===1&&e(Ve,{}),C===2&&e(Be,{form:n}),C===3&&e(ze,{form:n}),C===4&&e(Ye,{}),C===5&&e(Ue,{})]}),e(Re,{open:!0,setOpen:()=>null,applyCards:u,onOk:()=>X(n.getFieldsValue(!0))})]})};export{st as default};
