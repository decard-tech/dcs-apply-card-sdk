import{r as p,u as P,M,a as O,b as U,O as B,P as C,Q as _,R as v,T as L,U as x,V as k,W as R,X as F,j as c,e as o,B as N,K as l,f as J,Y as q,t as h,Z as V,_ as W,h as m}from"./index-6701bc4a.js";const z="/static/desc_icon_pass-a5824fa1.png",D="/static/desc_icon_safe-1fd9140e.png",T="/static/desc_icon_sing-abc808b7.png",K=p.memo(()=>{const t=P(e=>e.user),[g]=M(),a=O(),d=U(),u=B();let f=u.state;const[I,w]=p.useState([]),y=e=>{const{fromPath:s,appRoute:i,actionUrl:n}=Object.fromEntries(g.entries());if(a(q(e)),console.log("userStore这是",t),console.log("appRoute这是",i),console.log("actionUrl这是",n),console.log("fromPath这是",s),t.showCardList===0){console.log("走了这里"),j(e);return}if(s==="ScanCodePage"&&i==="ApplyCardDetail"&&n)return d(`/apply-card-detail?url=${n}`);d("/apply-card",{state:{back:!0}})},S=()=>{var s,i,n;if(console.log("userStore",t.sdkData),!((s=t==null?void 0:t.sdkData)!=null&&s.productInfo))return;let e=(i=t==null?void 0:t.sdkData)==null?void 0:i.productInfo.map(r=>r.productCode);console.log("productCodeList",e),h("/dcs-apply-online/card/apply/login/queryCardsList/sdk",{orgCode:(n=t.userInfo)==null?void 0:n.orgCode,applicationType:1,cardSdkExternalParam:{productCodeList:e}}).then(r=>{console.log("res======",r),w(r)})};function A(e,s){console.log("这是A的数据",s),console.log("这是B的数据",e);const i=new Set(s.map(n=>n.channelCreditCardId));return e.filter(n=>i.has(n.channelCreditCardId))}const j=e=>{var s;console.log("userStore",t.sdkData),h("/dcs-apply-online/credit/product/info/getCardId",{productCodeList:(s=t==null?void 0:t.sdkData)==null?void 0:s.productInfo}).then(i=>{let n=A(I,i);console.log("LLLLLLLLLLLL",n,i),a(V(n)),a(W(i)),E(e)})},E=e=>{e===2?h("/dcs-apply-online/myinfo/getAuthoriseUrl/v3",{version:"v2"}).then(s=>{location.href=s.requestUrl}):e===3?d("/manual/0"):e===4&&d("/ApplyIDVerification")};p.useEffect(()=>{S(),b();const e=()=>{document.visibilityState==="visible"&&(console.log("现在成功从myinfo回来了啊",window.location.origin),console.log("params",u.pathname),b())};return document.addEventListener("visibilitychange",e),()=>{console.log("ApplicationCard.useEffect卸载了",window.location.origin),console.log("params",u.pathname),document.removeEventListener("visibilitychange",e),a(C()),a(_("")),a(v("")),a(L()),a(x())}},[]);const b=()=>{typeof DcsCardBase!="undefined"&&(f!=null&&f.back||DcsCardBase.getMyinfoCallBack("",e=>{a(C()),a(_("")),a(v("")),a(L()),a(x()),console.log("卡申请页面,SUCESS======================================================",e);let s=JSON.parse(decodeURIComponent(JSON.parse(e).data));console.log("innerJsonObj2",s),s.host=="callback"&&d(`/myinfo/1?${s.query}`)},e=>{console.log("ERROR======================================================"),console.log("myinfo回调失败",e)}))};return p.useEffect(()=>{const{fromPath:e,mobile:s}=Object.fromEntries(g.entries());return a(e!=="ScanCodePage"?k(void 0):k(g.entries())),a(R(s)),()=>{console.log("componentWillUnmount"),a(F())}},[]),c("div",{children:[c("div",{className:"m-2.5 px-5 py-2 bg-white rounded-xl shadow-lg ",children:[o(l,{className:"text-left text-lg my-5 font-bold",id:"card_singpass_app_title"}),o(m,{src:T,width:106,height:18}),c("div",{className:"flex my-4",children:[o(m,{src:D,width:46,height:44}),c("div",{className:"pl-3 font-medium text-base text-minor",children:[o(l,{id:"card_singpass_disc1"}),o(l,{id:"card_singpass_disc2"})]})]}),o("div",{className:"flex items-center pb-7",children:o(N,{block:!0,shape:"rounded",color:"primary",size:"large",onClick:y.bind(void 0,2),children:o(l,{id:"card_singpass_login"})})})]}),c("div",{className:"m-2.5 px-5 py-2 bg-white rounded-xl shadow-lg ",children:[o(l,{className:"text-left text-lg my-5 font-bold",id:"card_jumio_app_title"}),c("div",{className:"flex my-4",children:[c("div",{children:[o(m,{src:z,width:41,className:"ml-2 mb-3"}),o(m,{src:D,width:55})]}),c("div",{className:"pl-3 font-medium text-base text-minor",children:[o(l,{id:"card_jumio_disc1",className:"mb-2"}),o(l,{id:"card_jumio_disc2",className:"mb-2"}),o(l,{id:"card_jumio_disc3"})]})]}),o("div",{className:"flex items-center pb-7",children:o(N,{block:!0,shape:"rounded",color:"primary",size:"large",onClick:y.bind(void 0,4),children:o(J,{id:"apply__apply_now"})})})]})]})});export{K as default};
